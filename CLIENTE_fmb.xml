<?xml version = '1.0' encoding = 'UTF-8'?>
<Module version="122010400" xmlns="http://xmlns.oracle.com/Forms">
   <FormModule Name="CLIENTE" DirtyInfo="true" Title="MODULE1" ConsoleWindow="W_PRINCIPAL" MenuModule="DEFAULT&amp;SMARTBAR">
      <Coordinate CharacterCellWidth="9" RealUnit="Ponto" DefaultFontScaling="true" CharacterCellHeight="16" CoordinateSystem="Real"/>
      <Alert Name="ALR_CONFIRMA_DELETE" DirtyInfo="true" Button1Label="Sim" Button2Label="Não" Title="Confirmação" AlertMessage="Confirma a exclusão do registro?" AlertStyle="Cuidado"/>
      <Block Name="TB_CLIENTE_VIEW" QueryDataSourceName="PKG_CLIENTE.PRC_LISTAR_CLIENTES" RecordsDisplayCount="10" DirtyInfo="true" QueryDataSourceType="Procedimento" ScrollbarWidth="18" ScrollbarLength="158">
         <Item Name="ID_CLIENTE" Prompt="Id Cliente" Required="true" PrimaryKey="true" DirtyInfo="true" Width="99" MaximumLength="40" ItemType="Item de Texto" ColumnName="ID_CLIENTE" DataType="Number" Height="16"/>
         <Item Name="NOME" Prompt="Nome" Required="true" DirtyInfo="true" Width="549" MaximumLength="100" ItemType="Item de Texto" ColumnName="NOME" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="EMAIL" Prompt="Email" Required="true" DirtyInfo="true" Width="549" MaximumLength="100" ItemType="Item de Texto" ColumnName="EMAIL" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="CEP" Prompt="Cep" DirtyInfo="true" Width="81" MaximumLength="8" ItemType="Item de Texto" ColumnName="CEP" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="LOGRADOURO" Prompt="Logradouro" DirtyInfo="true" Width="549" MaximumLength="150" ItemType="Item de Texto" ColumnName="LOGRADOURO" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="BAIRRO" Prompt="Bairro" DirtyInfo="true" Width="549" MaximumLength="100" ItemType="Item de Texto" ColumnName="BAIRRO" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="CIDADE" Prompt="Cidade" DirtyInfo="true" Width="549" MaximumLength="100" ItemType="Item de Texto" ColumnName="CIDADE" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="UF" Prompt="Uf" Required="true" DirtyInfo="true" Width="27" MaximumLength="2" ItemType="Item de Texto" ColumnName="UF" DataLengthSemantics="BYTE" Height="16"/>
         <Item Name="ATIVO" Prompt="Ativo" DirtyInfo="true" Width="27" MaximumLength="2" ItemType="Item de Texto" ColumnName="ATIVO" DataType="Number" Height="16"/>
         <Item Name="DT_CRIACAO" Prompt="Dt Criacao" Required="true" DirtyInfo="true" Width="99" MaximumLength="10" ItemType="Item de Texto" ColumnName="DT_CRIACAO" DataType="Date" Height="16"/>
         <Item Name="DT_ATUALIZACAO" Prompt="Dt Atualizacao" DirtyInfo="true" Width="99" MaximumLength="10" ItemType="Item de Texto" ColumnName="DT_ATUALIZACAO" DataType="Date" Height="16"/>
         <DataSourceArgument DSAName="NOME" DSAType="VARCHAR2" DSAValue=":CONTROL.NOME_FILTRO" Type="Query" DSATypeName="" DSAMode="IN"/>
         <DataSourceArgument DSAName="EMAIL" DSAType="VARCHAR2" DSAValue=":CONTROL.EMAIL_FILTRO" Type="Query" DSATypeName="" DSAMode="IN"/>
         <DataSourceArgument DSAName="P_RC" DSAType="REFCURSOR" DSAValue="" Type="Query" DSATypeName="" DSAMode="IN OUT"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="true" DSCPrecision="0" DSCName="ID_CLIENTE" DSCScale="0" DSCType="NUMBER" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="true" DSCPrecision="0" DSCName="NOME" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="true" DSCPrecision="0" DSCName="EMAIL" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="8" DSCMandatory="false" DSCPrecision="0" DSCName="CEP" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="150" DSCMandatory="false" DSCPrecision="0" DSCName="LOGRADOURO" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="false" DSCPrecision="0" DSCName="BAIRRO" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="false" DSCPrecision="0" DSCName="CIDADE" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="2" DSCMandatory="true" DSCPrecision="0" DSCName="UF" DSCScale="0" DSCType="CHAR" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="false" DSCPrecision="1" DSCName="ATIVO" DSCScale="0" DSCType="NUMBER" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="true" DSCPrecision="0" DSCName="DT_CRIACAO" DSCScale="0" DSCType="DATE" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="false" DSCPrecision="0" DSCName="DT_ATUALIZACAO" DSCScale="0" DSCType="DATE" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="false" DSCPrecision="0" DSCName="" DSCScale="0" DSCType="VARCHAR2" Type="Query"/>
      </Block>
      <Block Name="CONTROL" DirtyInfo="true" ScrollbarWidth="18" ScrollbarLength="158">
         <Item Name="NOME_FILTRO" XPosition="5" YPosition="19" DirtyInfo="true" TabPageName="" Width="90" CanvasName="C_PESQUISA" Height="16"/>
         <Item Name="EMAIL_FILTRO" XPosition="106" YPosition="19" DirtyInfo="true" TabPageName="" Width="90" CanvasName="C_PESQUISA" Height="16"/>
         <Item Name="BTN_EXECUTAR_PESQUISA" XPosition="217" YPosition="18" DirtyInfo="true" TabPageName="" Label="Executar Pesquisa" Width="90" CanvasName="C_PESQUISA" ItemType="Tecla" Height="16">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="-- Trigger: WHEN-BUTTON-PRESSED (Botão BTN_EXECUTAR_PESQUISA)&amp;#10;DECLARE&amp;#10;    v_hits NUMBER;&amp;#10;BEGIN&amp;#10;&amp;#10;    -- 1. Validação do filtro&amp;#10;    IF :CONTROL.NOME_FILTRO IS NULL AND :CONTROL.EMAIL_FILTRO IS NULL THEN&amp;#10;        MESSAGE('Informe nome ou email para pesquisar.');&amp;#10;        RAISE FORM_TRIGGER_FAILURE;&amp;#10;    END IF;&amp;#10;&amp;#10;    -- 2. Executa a query usando a procedure (Forms usa os argumentos mapeados acima)&amp;#10;    EXECUTE_QUERY;&amp;#10;&amp;#10;    -- 3. Fecha janela de pesquisa&amp;#10;    HIDE_WINDOW('W_PESQUISA_CLIENTE');&amp;#10;&amp;#10;    -- 4. Conta registros retornados (Solução para o erro LAST_RECORDS)&amp;#10;    v_hits := GET_BLOCK_PROPERTY('TB_CLIENTE_VIEW', QUERY_HITS);&amp;#10;&amp;#10;    IF NVL(v_hits, 0) = 0 THEN&amp;#10;        MESSAGE('Nenhum cliente encontrado.');&amp;#10;        -- Não use RAISE FORM_TRIGGER_FAILURE aqui se a query rodou bem, &amp;#10;        -- apenas não houve resultados.&amp;#10;    ELSE&amp;#10;        MESSAGE(TO_CHAR(v_hits) || ' clientes encontrados.');&amp;#10;        GO_ITEM('TB_CLIENTE_VIEW.ID_CLIENTE'); &amp;#10;        SYNCHRONIZE;&amp;#10;    END IF;&amp;#10;&amp;#10;EXCEPTION&amp;#10;    WHEN OTHERS THEN&amp;#10;        -- Intercepta o erro 20000 gerado pela sua procedure (RAISE_APPLICATION_ERROR)&amp;#10;        IF SQLCODE = -20000 AND INSTR(SQLERRM, 'Nenhum cliente encontrado') > 0 THEN&amp;#10;            MESSAGE('Nenhum cliente encontrado com os critérios informados.');&amp;#10;            GO_ITEM('CONTROL.NOME_FILTRO');&amp;#10;            &amp;#10;        ELSE&amp;#10;            -- Tratamento genérico de erro (Opcional: chamar PRC_INSERIR_LOG_ERRO)&amp;#10;            MESSAGE('Erro inesperado: ' || SQLERRM);&amp;#10;        END IF;&amp;#10;&amp;#10;        RAISE FORM_TRIGGER_FAILURE;&amp;#10;END;"/>
         </Item>
      </Block>
      <Block Name="TB_CLIENTE" QueryDataSourceName="TB_CLIENTE" DirtyInfo="true" ScrollbarWidth="18" ScrollbarLength="158">
         <Item Name="ID_CLIENTE" Enabled="false" DistanceBetweenRecords="128" Width="99" MaximumLength="40" XPosition="74" Required="true" YPosition="33" PromptFontName="Segoe UI" CanvasName="PRINCIPAL" ItemsDisplay="0" Height="16" Prompt="ID" TabPageName="" PromptAttachmentOffset="9" PromptFontSize="900" ItemType="Item de Texto" DataType="Number" DirtyInfo="true" PromptFontStyle="Simples" PromptFontWeight="Semiclaro" PromptFontSpacing="Normal" ColumnName="ID_CLIENTE" PromptDisplayStyle="Todos os Registros" LovName="LOV_CLIENTES"/>
         <Item Name="NOME" Prompt="Nome" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="549" MaximumLength="100" ItemType="Item de Texto" XPosition="74" Required="true" YPosition="49" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="NOME" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16" LovName="LOV_CLIENTES"/>
         <Item Name="EMAIL" Prompt="Email" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="549" MaximumLength="100" ItemType="Item de Texto" XPosition="74" Required="true" YPosition="65" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="EMAIL" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16" LovName="LOV_CLIENTES">
            <Trigger Name="WHEN-VALIDATE-ITEM" DirtyInfo="true" TriggerText="DECLARE&amp;#10;&amp;#10;VA_RESULTADO NUMBER;&amp;#10;&amp;#10;BEGIN&amp;#10;&amp;#10; VA_RESULTADO := PKG_CLIENTE.FN_VALIDAR_EMAIL(:TB_CLIENTE.EMAIL);&amp;#10; &amp;#10; IF VA_RESULTADO = 0 THEN&amp;#10; &amp;#10; MESSAGE('Email: '||:TB_CLIENTE.EMAIL|| ' '||'Inválido');&amp;#10; &amp;#10; SYNCHRONIZE;&amp;#10; &amp;#10; RAISE Form_Trigger_Failure;&amp;#10; &amp;#10; END IF;&amp;#10; &amp;#10;END;"/>
         </Item>
         <Item Name="CEP" Prompt="Cep" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="81" MaximumLength="8" ItemType="Item de Texto" XPosition="74" YPosition="81" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="CEP" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16">
            <Trigger Name="WHEN-VALIDATE-ITEM" DirtyInfo="true" TriggerText=":TB_CLIENTE.CEP := PKG_CLIENTE.FN_NORMALIZAR_CEP(:TB_CLIENTE.CEP);"/>
         </Item>
         <Item Name="LOGRADOURO" Prompt="Logradouro" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="549" MaximumLength="150" ItemType="Item de Texto" XPosition="74" YPosition="97" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="LOGRADOURO" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16"/>
         <Item Name="BAIRRO" Prompt="Bairro" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="549" MaximumLength="100" ItemType="Item de Texto" XPosition="74" YPosition="113" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="BAIRRO" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16"/>
         <Item Name="CIDADE" Prompt="Cidade" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="549" MaximumLength="100" ItemType="Item de Texto" XPosition="74" YPosition="129" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="CIDADE" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16"/>
         <Item Name="UF" Prompt="Uf" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="27" MaximumLength="2" ItemType="Item de Texto" XPosition="74" Required="true" YPosition="145" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="UF" PromptDisplayStyle="Todos os Registros" DataLengthSemantics="BYTE" ItemsDisplay="0" Height="16" LovName="LOV_UF"/>
         <Item Name="ATIVO" Prompt="Ativo" TabPageName="" PromptAttachmentOffset="9" DistanceBetweenRecords="128" Width="27" MaximumLength="2" ItemType="Item de Texto" DataType="Number" XPosition="74" YPosition="159" DirtyInfo="true" CanvasName="PRINCIPAL" ColumnName="ATIVO" PromptDisplayStyle="Todos os Registros" ItemsDisplay="0" Height="18"/>
         <Item Name="BT_NOVO_CLIENTE" Width="83" ItemType="Tecla" BackColor="white" XPosition="14" FontName="Segoe UI" YPosition="212" FontSize="900" FontStyle="Simples" DirtyInfo="true" FontWeight="Semiclaro" Label="Novo" FontSpacing="Normal" ForegroundColor="black" CanvasName="PRINCIPAL" Height="19">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="BEGIN&amp;#10;    -- 1. Limpa todos os itens e registros do formulário.&amp;#10;    -- O parâmetro NO_VALIDATE_AND_COMMIT garante que a ação seja forçada&amp;#10;    -- sem perguntar ao usuário sobre transações pendentes.&amp;#10;    CLEAR_FORM(NO_VALIDATE);&amp;#10;&amp;#10;    -- 2. Posiciona o cursor no primeiro campo de entrada (NOME).&amp;#10;    -- Garante que o usuário possa começar a digitar imediatamente.&amp;#10;    GO_ITEM('CLIENTE.NOME');&amp;#10;&amp;#10;    -- Mensagem opcional para confirmar a limpeza&amp;#10;    MESSAGE('Pronto para novo registro. Preencha os campos.');&amp;#10;    SYNCHRONIZE;&amp;#10;END;"/>
         </Item>
         <Item Name="BT_SALVAR" Width="83" ItemType="Tecla" BackColor="white" XPosition="110" FontName="Segoe UI" YPosition="212" FontSize="900" FontStyle="Simples" DirtyInfo="true" FontWeight="Semiclaro" Label="Salvar" FontSpacing="Normal" ForegroundColor="black" CanvasName="PRINCIPAL" Height="19">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="BEGIN&amp;#10;&amp;#10;  -- 1. Validação de Alterações Pendentes&amp;#10;  IF :SYSTEM.FORM_STATUS = 'CHANGED' THEN&amp;#10;    &amp;#10;    -- Se ID_CLIENTE é NULO, é uma INSERÇÃO.&amp;#10;    IF :TB_CLIENTE.ID_CLIENTE IS NULL THEN&amp;#10;      &amp;#10;      -- *** FLUXO DE INSERÇÃO ***&amp;#10;      PRC_INSERIR_CLIENTE(&amp;#10;        &amp;#10;        p_nome       => :TB_CLIENTE.NOME,&amp;#10;        p_email      => :TB_CLIENTE.EMAIL,&amp;#10;        p_cep        => :TB_CLIENTE.CEP,&amp;#10;        p_logradouro => :TB_CLIENTE.LOGRADOURO,&amp;#10;        p_bairro     => :TB_CLIENTE.BAIRRO,&amp;#10;        p_cidade     => :TB_CLIENTE.CIDADE,&amp;#10;        p_uf         => :TB_CLIENTE.UF,&amp;#10;        p_ativo      => :TB_CLIENTE.ATIVO&amp;#10;      );      &amp;#10;      &amp;#10;      -- Confirma a transação&amp;#10;      COMMIT;      &amp;#10;      &amp;#10;&amp;#10;    ELSE&amp;#10;      &amp;#10;      -- *** FLUXO DE ATUALIZAÇÃO ***&amp;#10;      &amp;#10;      -- Chama a Stored Procedure do Banco de Dados para Atualizar&amp;#10;      PRC_ATUALIZAR_CLIENTE(&amp;#10;        p_id         => :TB_CLIENTE.ID_CLIENTE,&amp;#10;        p_nome       => :TB_CLIENTE.NOME,&amp;#10;        p_email      => :TB_CLIENTE.EMAIL,&amp;#10;        p_cep        => :TB_CLIENTE.CEP,&amp;#10;        p_logradouro => :TB_CLIENTE.LOGRADOURO,&amp;#10;        p_bairro     => :TB_CLIENTE.BAIRRO,&amp;#10;        p_cidade     => :TB_CLIENTE.CIDADE,&amp;#10;        p_uf         => :TB_CLIENTE.UF,&amp;#10;        p_ativo      => :TB_CLIENTE.ATIVO&amp;#10;      );&amp;#10;      &amp;#10;      -- Confirma a transação&amp;#10;      COMMIT;      &amp;#10;      &amp;#10;      &amp;#10;    END IF; -- Fim da verificação ID_CLIENTE IS NULL&amp;#10;    &amp;#10;    SYNCHRONIZE; -- Força a atualização da tela&amp;#10;    &amp;#10;  ELSE&amp;#10;    -- Não houve alterações detectadas pelo Forms&amp;#10;    MESSAGE('Nenhuma alteração pendente para salvar.');&amp;#10;  END IF;&amp;#10;&amp;#10;EXCEPTION&amp;#10;  -- Tratamento de Erro (o ON-ERROR também será disparado)&amp;#10;  WHEN OTHERS THEN&amp;#10;  &amp;#10;    -- Chama a procedure do banco de dados&amp;#10;        PRC_INSERIR_LOG_ERRO(&amp;#10;            p_usuario     => :GLOBAL.USUARIO_LOGADO, -- Variável de sessão&amp;#10;            p_origem      => 'CLIENTE.FMB - PRE-INSERT', &amp;#10;            p_mensagem    => SQLERRM,                -- Mensagem de erro do Oracle&amp;#10;            p_codigo_erro => SQLCODE&amp;#10;        );&amp;#10;        -- Mensagem amigável para o usuário&amp;#10;        MESSAGE('Erro no sistema. Detalhes registrados no log. (' || TO_CHAR(SQLCODE) || ')');&amp;#10;        RAISE Form_Trigger_Failure; &amp;#10;   &amp;#10;END SALVAR_CLIENTE;"/>
         </Item>
         <Item Name="BT_EXCLUIR" Width="83" ItemType="Tecla" BackColor="white" XPosition="206" FontName="Segoe UI" YPosition="212" FontSize="900" FontStyle="Simples" DirtyInfo="true" FontWeight="Semiclaro" Label="Excluir" FontSpacing="Normal" ForegroundColor="black" CanvasName="PRINCIPAL" Height="19">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="DECLARE&amp;#10;   v_res NUMBER;&amp;#10;BEGIN&amp;#10;   v_res := SHOW_ALERT('ALR_CONFIRMA_DELETE');&amp;#10;&amp;#10;   IF v_res = ALERT_BUTTON1 THEN&amp;#10;       DELETE_RECORD;&amp;#10;       COMMIT_FORM;&amp;#10;&amp;#10;       MESSAGE('Registro excluído com sucesso.');&amp;#10;       SYNCHRONIZE;&amp;#10;   ELSE&amp;#10;       MESSAGE('Operação cancelada.');&amp;#10;       RAISE Form_Trigger_Failure;&amp;#10;   END IF;&amp;#10;&amp;#10;END;"/>
         </Item>
         <Item Name="BT_PESQUISAR" Width="83" ItemType="Tecla" BackColor="white" XPosition="643" FontName="Segoe UI" YPosition="15" FontSize="900" FontStyle="Simples" DirtyInfo="true" FontWeight="Semiclaro" Label="Pesquisar" FontSpacing="Normal" ForegroundColor="black" CanvasName="PRINCIPAL" Height="19">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="-- Trigger: WHEN-BUTTON-PRESSED (Botão PESQUISAR da tela principal)&amp;#10;BEGIN&amp;#10;    -- Limpa filtros antigos e erros&amp;#10;    CLEAR_BLOCK('CONTROL');&amp;#10;    &amp;#10;    -- Abre a janela de pesquisa&amp;#10;    GO_ITEM('CONTROL.NOME_FILTRO');&amp;#10;    SHOW_WINDOW('W_PESQUISA_CLIENTE');&amp;#10;    &amp;#10;END;"/>
         </Item>
         <Item Name="BT_CANCELAR" Width="83" ItemType="Tecla" BackColor="white" XPosition="304" FontName="Segoe UI" YPosition="212" FontSize="900" FontStyle="Simples" DirtyInfo="true" FontWeight="Semiclaro" Label="Cancelar" FontSpacing="Normal" ForegroundColor="black" CanvasName="PRINCIPAL" Height="19">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="-- Trigger: WHEN-BUTTON-PRESSED (Botão CANCELAR)&amp;#10;BEGIN&amp;#10;&#x9;&amp;#10;&#x9; IF :SYSTEM.FORM_STATUS = 'CHANGED' THEN&#x9; &amp;#10;   ROLLBACK;&amp;#10;   CLEAR_FORM(NO_VALIDATE);       &amp;#10;   MESSAGE('Dados inseridos apagados');&amp;#10;   END IF;&amp;#10;   &amp;#10;   &amp;#10;END;"/>
         </Item>
         <DataSourceColumn DSCLength="0" DSCMandatory="true" DSCPrecision="0" DSCName="ID_CLIENTE" DSCScale="-127" DSCType="NUMBER" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="true" DSCPrecision="0" DSCName="NOME" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="true" DSCPrecision="0" DSCName="EMAIL" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="8" DSCMandatory="false" DSCPrecision="0" DSCName="CEP" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="150" DSCMandatory="false" DSCPrecision="0" DSCName="LOGRADOURO" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="false" DSCPrecision="0" DSCName="BAIRRO" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="100" DSCMandatory="false" DSCPrecision="0" DSCName="CIDADE" DSCScale="0" DSCType="VARCHAR2" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="2" DSCMandatory="true" DSCPrecision="0" DSCName="UF" DSCScale="0" DSCType="CHAR" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="false" DSCPrecision="1" DSCName="ATIVO" DSCScale="0" DSCType="NUMBER" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="true" DSCPrecision="0" DSCName="DT_CRIACAO" DSCScale="0" DSCType="DATE" DSCNochildren="false" Type="Query"/>
         <DataSourceColumn DSCLength="0" DSCMandatory="false" DSCPrecision="0" DSCName="DT_ATUALIZACAO" DSCScale="0" DSCType="DATE" DSCNochildren="false" Type="Query"/>
         <Trigger Name="ON-ERROR" DirtyInfo="true" TriggerText="-- Trigger: ON-ERROR (Nível Formulário)&amp;#10;BEGIN&amp;#10;    -- Verifica se o erro é uma violação de Unique Constraint (ORA-00001)&amp;#10;    IF ERROR_CODE = 1 THEN&amp;#10;        -- Verifica se o texto do erro faz menção à constraint de E-MAIL&amp;#10;        IF INSTR(ERROR_TEXT, 'UQ_TB_CLIENTE_EMAIL') > 0 THEN&amp;#10;            &amp;#10;            -- Exibe a mensagem amigável e específica para o usuário&amp;#10;            MESSAGE('ERRO: O endereço de e-mail ' || :TB_CLIENTE.EMAIL || ' já está cadastrado.');&amp;#10;            &amp;#10;            -- Opcional: Posiciona o cursor de volta no campo E-MAIL&amp;#10;            GO_ITEM('TB_CLIENTE.EMAIL');&amp;#10;            &amp;#10;            -- Falha a trigger, impedindo que o Forms continue o processo com o erro.&amp;#10;            RAISE Form_Trigger_Failure;&amp;#10;        END IF;&amp;#10;    END IF;&amp;#10;END;    "/>
      </Block>
      <Canvas Name="C_PESQUISA" DirtyInfo="true" Width="720" WindowName="W_PESQUISA_CLIENTE" Height="378" ViewportHeight="378" ViewportWidth="720"/>
      <Canvas Name="PRINCIPAL" CanvasType="Conteúdo" DirtyInfo="true" Width="752" WindowName="W_PRINCIPAL" Height="376" ViewportHeight="378" ViewportWidth="720">
         <Graphics Name="FRAME5" Width="623" EdgeBackColor="white" FillPattern="none" EdgePattern="solid" FrameTitleOffset="18" XPosition="9" FrameTitleSpacing="9" YPosition="17" FrameTitle="Clientes" Bevel="Inset" DirtyInfo="true" LayoutDataBlockName="TB_CLIENTE" GraphicsType="Quadro" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="16" HorizontalObjectOffset="18" Height="176" StartPromptOffset="9"/>
      </Canvas>
      <LOV Name="LOV_CLIENTES" DirtyInfo="true" AutoPosition="true" Title="Clientes Ativos" Width="360" RecordGroupName="REG_CLIENTES" Height="158">
         <LOVColumnMapping Name="ID_CLIENTE" ReturnItem="TB_CLIENTE.ID_CLIENTE" DirtyInfo="true" Title="Id_Cliente" DisplayWidth="216"/>
         <LOVColumnMapping Name="NOME" ReturnItem="TB_CLIENTE.NOME" DirtyInfo="true" Title="Nome" DisplayWidth="909"/>
         <LOVColumnMapping Name="EMAIL" ReturnItem="TB_CLIENTE.EMAIL" DirtyInfo="true" Title="Email" DisplayWidth="909"/>
      </LOV>
      <LOV Name="LOV_UF" DirtyInfo="true" AutoPosition="true" Title="UF" Width="360" RecordGroupName="REG_UF" Height="158">
         <LOVColumnMapping Name="UF" ReturnItem="TB_CLIENTE.UF" DirtyInfo="true" Title="Uf" DisplayWidth="27"/>
      </LOV>
      <LOV Name="LOV_ATIVO" DirtyInfo="true" AutoPosition="true" Title="Ativo" Width="360" RecordGroupName="REG_ATIVO" Height="158">
         <LOVColumnMapping Name="SIM" ReturnItem="TB_CLIENTE.ATIVO" DirtyInfo="true" Title="Ativo" DisplayWidth="54"/>
      </LOV>
      <ProgramUnit Name="PRC_INSERIR_CLIENTE" ProgramUnitText="PROCEDURE PRC_INSERIR_CLIENTE (&amp;#10;       &amp;#10;    p_nome       IN TB_CLIENTE.NOME%TYPE,&amp;#10;    p_email      IN TB_CLIENTE.EMAIL%TYPE,&amp;#10;    p_cep        IN TB_CLIENTE.CEP%TYPE,&amp;#10;    p_logradouro IN TB_CLIENTE.LOGRADOURO%TYPE,&amp;#10;    p_bairro     IN TB_CLIENTE.BAIRRO%TYPE,&amp;#10;    p_cidade     IN TB_CLIENTE.CIDADE%TYPE,&amp;#10;    p_uf         IN TB_CLIENTE.UF%TYPE,&amp;#10;    p_ativo      IN TB_CLIENTE.ATIVO%TYPE&amp;#10;)&amp;#10;IS&amp;#10;        &amp;#10;BEGIN&amp;#10;    &amp;#10;    INSERT INTO TB_CLIENTE (&amp;#10;        NOME,&amp;#10;        EMAIL,&amp;#10;        CEP,&amp;#10;        LOGRADOURO,&amp;#10;        BAIRRO,&amp;#10;        CIDADE,&amp;#10;        UF,&amp;#10;        ATIVO,&amp;#10;        DT_ATUALIZACAO -- Preenchido aqui, pois DT_CRIACAO é preenchida pela trigger&amp;#10;    )&amp;#10;    VALUES (&amp;#10;        p_nome,&amp;#10;        p_email,&amp;#10;        p_cep,&amp;#10;        p_logradouro,&amp;#10;        p_bairro,&amp;#10;        p_cidade,&amp;#10;        p_uf,&amp;#10;        p_ativo,&amp;#10;        SYSDATE&amp;#10;    );&amp;#10;   &amp;#10;    MESSAGE('Cliente ' || p_nome || ' Inserido com sucesso.');&amp;#10;    &amp;#10;    &amp;#10;EXCEPTION&amp;#10;    -- Se ocorrer algum erro (ex: violação da restrição de e-mail UNIQUE)&amp;#10;    WHEN OTHERS THEN&amp;#10;        -- Loga o erro na tabela TB_LOG_ERRO (assume-se que PK_CLIENTE.PRC_INSERIR_LOG_ERRO existe)&amp;#10;        PRC_INSERIR_LOG_ERRO(&amp;#10;                              p_usuario     => USER,&amp;#10;                              p_origem      => 'PK_CLIENTE.PRC_INSERIR_CLIENTE',&amp;#10;                              p_mensagem    => SQLERRM,&amp;#10;                              p_codigo_erro => SQLCODE&amp;#10;                            );&amp;#10;        -- Propaga a exceção para que o Forms possa fazer rollback e falhar a transação&amp;#10;        RAISE;&amp;#10;END PRC_INSERIR_CLIENTE;&amp;#10;" ProgramUnitType="Procedimento"/>
      <ProgramUnit Name="PRC_ATUALIZAR_CLIENTE" ProgramUnitText="PROCEDURE PRC_ATUALIZAR_CLIENTE (&amp;#10;    p_id         IN TB_CLIENTE.ID_CLIENTE%TYPE, -- ID para identificar a linha a ser atualizada&amp;#10;    p_nome       IN TB_CLIENTE.NOME%TYPE,&amp;#10;    p_email      IN TB_CLIENTE.EMAIL%TYPE,&amp;#10;    p_cep        IN TB_CLIENTE.CEP%TYPE,&amp;#10;    p_logradouro IN TB_CLIENTE.LOGRADOURO%TYPE,&amp;#10;    p_bairro     IN TB_CLIENTE.BAIRRO%TYPE,&amp;#10;    p_cidade     IN TB_CLIENTE.CIDADE%TYPE,&amp;#10;    p_uf         IN TB_CLIENTE.UF%TYPE,&amp;#10;    p_ativo      IN TB_CLIENTE.ATIVO%TYPE&amp;#10;)&amp;#10;IS&amp;#10;BEGIN&amp;#10;    &amp;#10;    -- Atualiza os dados do cliente, incluindo a data de atualização&amp;#10;    UPDATE TB_CLIENTE SET&amp;#10;        NOME           = p_nome,&amp;#10;        EMAIL          = p_email,&amp;#10;        CEP            = p_cep,&amp;#10;        LOGRADOURO     = p_logradouro,&amp;#10;        BAIRRO         = p_bairro,&amp;#10;        CIDADE         = p_cidade,&amp;#10;        UF             = p_uf,&amp;#10;        ATIVO          = p_ativo,&amp;#10;        DT_ATUALIZACAO = SYSDATE -- Atualiza o timestamp de modificação&amp;#10;    WHERE&amp;#10;        ID_CLIENTE = p_id;&amp;#10;    &amp;#10;    &amp;#10;   -- Mensagem amigável de sucesso&amp;#10;   MESSAGE('Cliente ' || p_nome || ' atualizado com sucesso.');    &amp;#10;        &amp;#10;    -- Verificação opcional: se nenhuma linha foi atualizada (o ID não existe)&amp;#10;    IF SQL%NOTFOUND THEN&amp;#10;      &amp;#10;        PRC_INSERIR_LOG_ERRO(&amp;#10;            p_usuario      => user,&amp;#10;            p_origem      => 'PRC_ATUALIZAR_CLIENTE',&amp;#10;            p_mensagem    => 'ID não existe',&amp;#10;            p_codigo_erro => 9999&amp;#10;        );     &amp;#10;        &amp;#10;    END IF;&amp;#10;    &amp;#10;    -- Nota: O COMMIT deve ser executado na Program Unit/Trigger do Forms, e não aqui.&amp;#10;    &amp;#10;EXCEPTION&amp;#10;    -- Se ocorrer algum erro (ex: violação da restrição de e-mail UNIQUE)&amp;#10;    WHEN OTHERS THEN&amp;#10;        -- Loga o erro na tabela TB_LOG_ERRO (assume-se que PK_CLIENTE.PRC_INSERIR_LOG_ERRO existe)&amp;#10;        PRC_INSERIR_LOG_ERRO(&amp;#10;            p_usuario      => user,&amp;#10;            p_origem       => 'PRC_ATUALIZAR_CLIENTE',&amp;#10;            p_mensagem     => SQLERRM,&amp;#10;            p_codigo_erro  => SQLCODE&amp;#10;        );&amp;#10;        -- Propaga a exceção para que o Forms possa fazer rollback e falhar a transação&amp;#10;        RAISE;&amp;#10;END PRC_ATUALIZAR_CLIENTE;" ProgramUnitType="Procedimento"/>
      <RecordGroup Name="REG_UF" DirtyInfo="true" RecordGroupFetchSize="0" RecordGroupQuery="SELECT 'AC' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'AL' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'AP' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'AM' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'BA' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'CE' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'DF' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'ES' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'GO' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'MA' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'MT' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'MS' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'MG' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'PA' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'PB' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'PR' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'PE' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'PI' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'RJ' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'RN' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'RS' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'RO' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'RR' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'SC' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'SP' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'SE' AS UF FROM DUAL UNION ALL&amp;#10;SELECT 'TO' AS UF FROM DUAL">
         <RecordGroupColumn Name="UF" DirtyInfo="true" ColumnDataType="Character" MaximumLength="2" DataLengthSemantics="BYTE"/>
      </RecordGroup>
      <RecordGroup Name="REG_ATIVO" DirtyInfo="true" RecordGroupFetchSize="0" RecordGroupQuery="SELECT 0 AS Sim  FROM DUAL UNION ALL&amp;#10;SELECT 1 AS Nao FROM DUAL">
         <RecordGroupColumn Name="SIM" DirtyInfo="true" ColumnDataType="Number" MaximumLength="5" DataLengthSemantics="Nulo"/>
      </RecordGroup>
      <RecordGroup Name="REG_CLIENTES" DirtyInfo="true" RecordGroupFetchSize="0" RecordGroupQuery="SELECT &amp;#10;    ID_CLIENTE,&amp;#10;    NOME,&amp;#10;    EMAIL&amp;#10;FROM TB_CLIENTE&amp;#10;ORDER BY NOME" RecordGroupType="Consultar">
         <RecordGroupColumn Name="ID_CLIENTE" DirtyInfo="true" ColumnDataType="Number" MaximumLength="23" DataLengthSemantics="Nulo"/>
         <RecordGroupColumn Name="NOME" DirtyInfo="true" ColumnDataType="Character" MaximumLength="100" DataLengthSemantics="BYTE"/>
         <RecordGroupColumn Name="EMAIL" DirtyInfo="true" ColumnDataType="Character" MaximumLength="100" DataLengthSemantics="BYTE"/>
      </RecordGroup>
      <Trigger Name="WHEN-NEW-FORM-INSTANCE" DirtyInfo="true" TriggerText="GO_ITEM('TB_CLIENTE.NOME');"/>
      <Window Name="W_PESQUISA_CLIENTE" DirtyInfo="true" Width="720" Height="378"/>
      <Window Name="W_PRINCIPAL" DirtyInfo="true" Width="758" Height="378"/>
   </FormModule>
</Module>
